<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>JCAN Korean Language Center - Exams</title>

        <!-- CSS FILES -->        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@300;400;600;700&display=swap" rel="stylesheet">
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/bootstrap-icons.css" rel="stylesheet">
        <link href="css/templatemo-ebook-landing.css" rel="stylesheet">

        <style>
            .exam-container {
                padding: 40px 20px;
                min-height: 100vh;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            }

            .exam-section {
                margin-bottom: 50px;
            }

            .exam-title {
                color: white;
                text-align: center;
                font-size: 2.5rem;
                font-weight: 700;
                margin-bottom: 40px;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            }

            .exam-category-title {
                color: white;
                font-size: 2rem;
                font-weight: 600;
                margin-bottom: 30px;
                text-align: center;
                text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            }

            .buttons-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 20px;
                margin-bottom: 40px;
            }

            .exam-button {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: 2px solid white;
                padding: 25px;
                border-radius: 12px;
                font-size: 1.1rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                text-decoration: none;
                display: flex;
                align-items: center;
                justify-content: center;
                min-height: 120px;
                text-align: center;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            }

            .exam-button:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
                background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            }

            .exam-button:active {
                transform: translateY(-2px);
            }

            .reading-button {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                border-color: #4facfe;
            }

            .listening-button {
                background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                border-color: #f5576c;
            }

            .back-button-container {
                text-align: center;
                margin: 40px 0;
            }

            .back-button {
                background: white;
                color: #667eea;
                border: 2px solid white;
                padding: 12px 30px;
                border-radius: 8px;
                font-size: 1rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                text-decoration: none;
            }

            .back-button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            }

            .navbar {
                background-color: rgba(0, 0, 0, 0.1) !important;
            }

            .navbar-brand {
                color: white !important;
            }

            .navbar-brand img {
                filter: brightness(1.2);
            }

            .navbar-brand span {
                color: white;
                font-weight: 600;
            }

            .nav-link {
                color: white !important;
                transition: all 0.3s ease;
            }

            .nav-link:hover {
                color: #4facfe !important;
            }

            .question-timer {
                position: fixed;
                top: 100px;
                right: 20px;
                background: white;
                padding: 20px 30px;
                border-radius: 10px;
                font-size: 1.5rem;
                font-weight: 700;
                color: #667eea;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                z-index: 1000;
                display: none;
            }

            .question-timer.active {
                display: block;
            }

            .question-timer.warning {
                color: #f5576c;
                animation: pulse 1s infinite;
            }

            @keyframes pulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.05); }
            }

            .exam-modal {
                display: none;
                position: fixed;
                z-index: 2000;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                overflow: auto;
            }

            .exam-modal.active {
                display: block;
            }

            .modal-content {
                background-color: white;
                margin: 5% auto;
                padding: 30px;
                border-radius: 15px;
                border: 1px solid #888;
                width: 90%;
                max-width: 600px;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            }

            .modal-close {
                color: #aaa;
                float: right;
                font-size: 28px;
                font-weight: bold;
                cursor: pointer;
                transition: color 0.3s ease;
            }

            .modal-close:hover {
                color: #000;
            }

            .modal-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
                padding-bottom: 15px;
                border-bottom: 2px solid #667eea;
            }

            .modal-title {
                font-size: 1.5rem;
                font-weight: 600;
                color: #667eea;
            }

            .question-number {
                color: #999;
                font-size: 0.9rem;
            }

            .modal-buttons {
                display: flex;
                gap: 15px;
                margin-top: 30px;
            }

            .modal-btn {
                flex: 1;
                padding: 12px;
                border: none;
                border-radius: 8px;
                font-size: 1rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .modal-btn-back {
                background: white;
                color: #667eea;
                border: 2px solid #667eea;
            }

            .modal-btn-back:hover {
                background: #f0f0f0;
            }

            .modal-btn-next {
                background: #667eea;
                color: white;
            }

            .modal-btn-next:hover {
                background: #764ba2;
            }

            .question-content {
                margin: 20px 0;
                line-height: 1.6;
            }

            .question-content p {
                margin-bottom: 15px;
            }

            .answer-options {
                margin: 20px 0;
            }

            .answer-option {
                display: flex;
                align-items: center;
                margin: 15px 0;
                cursor: pointer;
                padding: 10px;
                border-radius: 8px;
                transition: all 0.3s ease;
            }

            .answer-option:hover {
                background: #f0f0f0;
            }

            .answer-option input[type="radio"] {
                margin-right: 15px;
                width: 20px;
                height: 20px;
                cursor: pointer;
            }

            .answer-option label {
                cursor: pointer;
                margin: 0;
                flex: 1;
            }

            .submit-button-container {
                text-align: center;
                margin-top: 30px;
                padding-top: 20px;
                border-top: 2px solid #ddd;
            }

            .submit-btn {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                padding: 15px 40px;
                border-radius: 8px;
                font-size: 1.1rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .submit-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            }

            /* Results Modal Styles */
            .results-modal {
                display: none;
                position: fixed;
                z-index: 2000;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                overflow: auto;
            }

            .results-modal.active {
                display: block;
            }

            .results-content {
                background-color: white;
                margin: 2% auto;
                padding: 30px;
                border-radius: 15px;
                width: 95%;
                max-width: 900px;
                max-height: 90vh;
                overflow-y: auto;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            }

            .results-header {
                text-align: center;
                margin-bottom: 30px;
                padding-bottom: 20px;
                border-bottom: 3px solid #667eea;
            }

            .score-display {
                font-size: 3rem;
                font-weight: 700;
                color: #667eea;
                margin: 20px 0;
            }

            .score-text {
                font-size: 1.3rem;
                color: #333;
                margin: 10px 0;
            }

            .score-details {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
                margin: 20px 0;
            }

            .score-card {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 20px;
                border-radius: 10px;
                text-align: center;
            }

            .score-card-value {
                font-size: 2rem;
                font-weight: 700;
                margin: 10px 0;
            }

            .score-card-label {
                font-size: 0.9rem;
                opacity: 0.9;
            }

            .results-title {
                font-size: 1.5rem;
                font-weight: 600;
                color: #333;
                margin-top: 30px;
                margin-bottom: 20px;
            }

            .wrong-answer-item {
                background: #fff3cd;
                border-left: 4px solid #ffc107;
                padding: 15px;
                margin-bottom: 15px;
                border-radius: 5px;
            }

            .wrong-answer-item.correct {
                background: #d4edda;
                border-left-color: #28a745;
            }

            .question-num {
                font-weight: 600;
                color: #667eea;
                margin-bottom: 10px;
            }

            .question-text {
                margin-bottom: 10px;
                line-height: 1.5;
            }

            .answer-feedback {
                margin-top: 10px;
            }

            .answer-feedback p {
                margin: 5px 0;
                font-size: 0.95rem;
            }

            .your-answer {
                color: #f5576c;
                font-weight: 500;
            }

            .correct-answer {
                color: #28a745;
                font-weight: 500;
            }

            .results-buttons {
                display: flex;
                gap: 15px;
                justify-content: center;
                margin-top: 30px;
                padding-top: 20px;
                border-top: 2px solid #ddd;
            }

            .result-btn {
                padding: 12px 30px;
                border: none;
                border-radius: 8px;
                font-size: 1rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .result-btn-primary {
                background: #667eea;
                color: white;
            }

            .result-btn-primary:hover {
                background: #764ba2;
                transform: translateY(-2px);
            }

            .result-btn-secondary {
                background: white;
                color: #667eea;
                border: 2px solid #667eea;
            }

            .result-btn-secondary:hover {
                background: #f0f0f0;
            }
        </style>
    </head>
    
    <body>

        <main>

            <nav class="navbar navbar-expand-lg sticky-top">
                <div class="container">
                    <a class="navbar-brand" href="index.html">
                        <img src="logo.png" alt="Logo" style="height:60px;">
                        <span>JCAN</span>
                    </a>

                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
    
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav ms-lg-auto me-lg-4">
                            <li class="nav-item">
                                <a class="nav-link" href="index.html">Home</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <div class="exam-container">
                <div class="container">
                    <h1 class="exam-title">EPS TOPIK Practice Exams</h1>

                    <!-- READING SECTION -->
                    <div class="exam-section">
                        <h2 class="exam-category-title">READING EXAM</h2>
                        <div class="buttons-grid" id="readingGrid">
                            <!-- Reading buttons will be generated here -->
                        </div>
                    </div>

                    <!-- LISTENING SECTION -->
                    <div class="exam-section">
                        <h2 class="exam-category-title">LISTENING EXAM</h2>
                        <div class="buttons-grid" id="listeningGrid">
                            <!-- Listening buttons will be generated here -->
                        </div>
                    </div>

                    <!-- BACK BUTTON -->
                    <div class="back-button-container">
                        <a href="index.html" class="back-button">← Back to Home</a>
                    </div>
                </div>
            </div>

            <!-- Timer Display -->
            <div class="question-timer" id="timerDisplay">
                Time Remaining: <span id="timerText">25:00</span>
            </div>

            <!-- Exam Modal -->
            <div class="exam-modal" id="examModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <div>
                            <div class="modal-title" id="modalTitle">Question</div>
                            <div class="question-number" id="questionNumber">Question 1 of 1</div>
                        </div>
                        <span class="modal-close" onclick="closeExam()">&times;</span>
                    </div>

                    <div class="question-content">
                        <p id="questionText">Sample question content will appear here.</p>
                    </div>

                    <div class="answer-options" id="answerOptions">
                        <!-- Answer options will be generated here -->
                    </div>

                    <div class="modal-buttons">
                        <button class="modal-btn modal-btn-back" onclick="previousQuestion()">← 이전</button>
                        <button class="modal-btn modal-btn-next" onclick="nextQuestion()">다음 →</button>
                    </div>

                    <div class="submit-button-container">
                        <button class="submit-btn" onclick="submitExam()">시험 제출</button>
                    </div>
                </div>
            </div>

            <!-- Results Modal -->
            <div class="results-modal" id="resultsModal">
                <div class="results-content">
                    <div class="results-header">
                        <h2>시험 결과</h2>
                        <div class="score-display" id="scoreDisplay">0/20</div>
                        <div class="score-text" id="scoreText">점수: 0점</div>
                        <div class="score-text" id="scorePercentage">정답률: 0%</div>
                    </div>

                    <div class="score-details">
                        <div class="score-card">
                            <div class="score-card-label">정답</div>
                            <div class="score-card-value" id="correctCount">0</div>
                        </div>
                        <div class="score-card">
                            <div class="score-card-label">오답</div>
                            <div class="score-card-value" id="incorrectCount">0</div>
                        </div>
                        <div class="score-card">
                            <div class="score-card-label">총 문제</div>
                            <div class="score-card-value" id="totalCount">20</div>
                        </div>
                    </div>

                    <div id="detailedResults">
                        <!-- Detailed results will be inserted here -->
                    </div>

                    <div class="results-buttons">
                        <button class="result-btn result-btn-primary" onclick="retakeExam()">다시 풀기</button>
                        <button class="result-btn result-btn-secondary" onclick="backToExams()">시험 목록으로</button>
                    </div>
                </div>
            </div>

        </main>

        <!-- JAVASCRIPT FILES -->
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.bundle.min.js"></script>
        <script src="js/jquery.sticky.js"></script>
        <script src="js/click-scroll.js"></script>
        <script src="js/custom.js"></script>

        <script>
            // Exam state
            const examState = {
                currentExamType: null, // 'reading' or 'listening'
                currentQuestionIndex: 0,
                timerInterval: null,
                timeRemaining: 25 * 60, // 25 minutes in seconds
                questions: [],
                answers: {},
                timerStarted: false
            };

            // Sample questions database - HRDK Korea EPS TOPIK Exam Questions (All Korean)
            const questionsDatabase = {
                reading: [
                    {
                        number: 1,
                        text: '**문장을 읽고 질문에 답하세요.**\n\n"제 이름은 김철수입니다. 저는 한국에서 왔습니다."\n\n사람이 어느 나라에서 왔습니까?',
                        options: ['필리핀', '한국', '일본', '중국'],
                        correctAnswer: 1
                    },
                    {
                        number: 2,
                        text: '**빈 칸에 맞는 조사를 선택하세요.**\n\n"나는 한국 _____ 왔습니다."\n\nㄱ) 에  ㄴ) 에서  ㄷ) 를  ㄹ) 이',
                        options: ['에', '에서', '를', '이'],
                        correctAnswer: 1
                    },
                    {
                        number: 3,
                        text: '**다음 문장의 의미와 같은 단어를 선택하세요.**\n\n"저는 공장에서 _____ 합니다."',
                        options: ['놀다', '공부하다', '일하다', '먹다'],
                        correctAnswer: 2
                    },
                    {
                        number: 4,
                        text: '**맞는 단어를 선택하세요.**\n\n"저는 내일 부산 _____ 가겠습니다."',
                        options: ['오다', '가다', '있다', '돌아가다'],
                        correctAnswer: 1
                    },
                    {
                        number: 5,
                        text: '**반대말을 선택하세요.**\n\n"오른쪽"의 반대말은?',
                        options: ['위', '아래', '왼쪽', '앞'],
                        correctAnswer: 2
                    },
                    {
                        number: 6,
                        text: '**다음 문장을 읽고 질문에 답하세요.**\n\n"저는 제조업 회사에서 근무합니다. 월급은 한 달에 3백만 원입니다."\n\n이 사람의 직업은 무엇입니까?',
                        options: ['의사', '선생님', '제조업 근무자', '경찰'],
                        correctAnswer: 2
                    },
                    {
                        number: 7,
                        text: '**올바른 대답을 선택하세요.**\n\n"지금 몇 시입니까?" - "___"',
                        options: ['좋습니다', '감사합니다', '오전 9시입니다', '안녕하세요'],
                        correctAnswer: 2
                    },
                    {
                        number: 8,
                        text: '**빈 칸에 맞는 조사를 선택하세요.**\n\n"어제 저는 공장 _____ 갔습니다."',
                        options: ['에', '를', '에서', '이'],
                        correctAnswer: 0
                    },
                    {
                        number: 9,
                        text: '**문장을 완성하세요.**\n\n"나는 매일 아침 6시 _____ 일어납니다."',
                        options: ['에', '를', '가', '이'],
                        correctAnswer: 0
                    },
                    {
                        number: 10,
                        text: '**의미가 같은 단어를 선택하세요.**\n\n"병원"과 의미가 같은 단어는?',
                        options: ['학교', '의사', '진료소', '경찰서'],
                        correctAnswer: 2
                    },
                    {
                        number: 11,
                        text: '**다음 문장을 읽고 질문에 답하세요.**\n\n"제 월급은 한 달에 3백만 원입니다."\n\n이 사람의 월급은 얼마입니까?',
                        options: ['200만 원', '300만 원', '400만 원', '500만 원'],
                        correctAnswer: 1
                    },
                    {
                        number: 12,
                        text: '**단어의 의미를 선택하세요.**\n\n"위험하다"의 의미는?',
                        options: ['안전한', '위험한', '쉬운', '어려운'],
                        correctAnswer: 1
                    },
                    {
                        number: 13,
                        text: '**빈 칸에 맞는 조사를 선택하세요.**\n\n"나는 한국말 _____ 배우고 있습니다."',
                        options: ['을', '를', '은', '이'],
                        correctAnswer: 1
                    },
                    {
                        number: 14,
                        text: '**단어의 의미를 선택하세요.**\n\n"주일에"는 무엇을 의미합니까?',
                        options: ['내일', '어제', '다음 주', '매일'],
                        correctAnswer: 2
                    },
                    {
                        number: 15,
                        text: '**다음 문장을 읽고 질문에 답하세요.**\n\n"저는 건설 회사에서 근무합니다."\n\n이 사람은 어느 산업에서 일합니까?',
                        options: ['제조업', '건설업', '농업', '어업'],
                        correctAnswer: 1
                    },
                    {
                        number: 16,
                        text: '**표현의 의미를 선택하세요.**\n\n"출장을 가다"의 의미는?',
                        options: ['휴가를 가다', '출장을 가다', '학교에 가다', '병원에 가다'],
                        correctAnswer: 1
                    },
                    {
                        number: 17,
                        text: '**의미가 같은 단어를 선택하세요.**\n\n"많다"와 의미가 같은 단어는?',
                        options: ['적다', '풍부하다', '없다', '모르다'],
                        correctAnswer: 1
                    },
                    {
                        number: 18,
                        text: '**문장을 완성하세요.**\n\n"내일은 날씨가 _____ 될 것입니다."',
                        options: ['춥다', '덥다', '흐리다', '맑다'],
                        correctAnswer: 0
                    },
                    {
                        number: 19,
                        text: '**다음 문장을 읽고 질문에 답하세요.**\n\n"이 음식은 매우 맛있고 건강합니다."\n\n음식의 어떤 특징입니까?',
                        options: ['싸고 좋다', '맛있고 건강하다', '쉽고 빠르다', '신선하고 새로운'],
                        correctAnswer: 1
                    },
                    {
                        number: 20,
                        text: '**단어의 의미를 선택하세요.**\n\n"중요하다"의 의미는?',
                        options: ['무겁다', '중요하다', '크다', '깨끗하다'],
                        correctAnswer: 1
                    }
                ],
                listening: [
                    { number: 1, text: 'Listen to the audio and select the correct answer: "What is she doing?"', options: ['Working', 'Reading', 'Cooking', 'Sleeping'], correctAnswer: 0 },
                    { number: 2, text: 'Listen and choose: "Where does he go?"', options: ['School', 'Market', 'Hospital', 'Park'], correctAnswer: 2 },
                    { number: 3, text: 'Comprehension: "What time is the meeting?"', options: ['9:00 AM', '10:00 AM', '2:00 PM', '3:00 PM'], correctAnswer: 1 },
                    { number: 4, text: 'Listen: "How many people are in the family?"', options: ['2', '3', '4', '5'], correctAnswer: 2 },
                    { number: 5, text: 'Question: "What did he eat?"', options: ['Rice', 'Bread', 'Noodles', 'Fruit'], correctAnswer: 2 },
                    { number: 6, text: 'Listen: "What color is the car?"', options: ['Red', 'Blue', 'White', 'Black'], correctAnswer: 3 },
                    { number: 7, text: 'Comprehension: "What is her job?"', options: ['Teacher', 'Nurse', 'Doctor', 'Engineer'], correctAnswer: 0 },
                    { number: 8, text: 'Listen: "How much does it cost?"', options: ['10,000 won', '20,000 won', '30,000 won', '40,000 won'], correctAnswer: 1 },
                    { number: 9, text: 'Question: "Where did they go yesterday?"', options: ['Cinema', 'Beach', 'Museum', 'Restaurant'], correctAnswer: 3 },
                    { number: 10, text: 'Listen: "What is the weather like?"', options: ['Rainy', 'Sunny', 'Cloudy', 'Windy'], correctAnswer: 1 },
                    { number: 11, text: 'Comprehension: "When will he arrive?"', options: ['Today', 'Tomorrow', 'Next week', 'Next month'], correctAnswer: 0 },
                    { number: 12, text: 'Listen: "What sport does she like?"', options: ['Soccer', 'Basketball', 'Tennis', 'Swimming'], correctAnswer: 2 },
                    { number: 13, text: 'Question: "How old is he?"', options: ['25', '30', '35', '40'], correctAnswer: 1 },
                    { number: 14, text: 'Listen: "What is she holding?"', options: ['Book', 'Phone', 'Umbrella', 'Bag'], correctAnswer: 0 },
                    { number: 15, text: 'Comprehension: "Which country does he want to visit?"', options: ['Japan', 'China', 'Korea', 'Thailand'], correctAnswer: 2 },
                    { number: 16, text: 'Listen: "What did they talk about?"', options: ['Work', 'Family', 'Vacation', 'Politics'], correctAnswer: 2 },
                    { number: 17, text: 'Question: "How long will the meeting last?"', options: ['30 minutes', '1 hour', '2 hours', '3 hours'], correctAnswer: 1 },
                    { number: 18, text: 'Listen: "What is the temperature?"', options: ['10°C', '15°C', '20°C', '25°C'], correctAnswer: 2 },
                    { number: 19, text: 'Comprehension: "When did they leave?"', options: ['Morning', 'Afternoon', 'Evening', 'Night'], correctAnswer: 0 },
                    { number: 20, text: 'Listen: "What is the main idea?"', options: ['Cooking', 'Shopping', 'Travel', 'Learning'], correctAnswer: 3 }
                ]
            };

            // Initialize the page
            function initializeExamPage() {
                generateButtons('reading');
                generateButtons('listening');
                loadTimerState();
            }

            // Generate buttons for each exam type
            function generateButtons(type) {
                const container = document.getElementById(type + 'Grid');
                const buttonClass = type === 'reading' ? 'reading-button' : 'listening-button';
                const count = type === 'reading' ? 20 : 20;

                for (let i = 1; i <= count; i++) {
                    const button = document.createElement('button');
                    button.className = `exam-button ${buttonClass}`;
                    button.textContent = `Q${i}`;
                    button.onclick = () => startExam(type, i - 1);
                    container.appendChild(button);
                }
            }

            // Start exam
            function startExam(type, questionIndex) {
                examState.currentExamType = type;
                examState.currentQuestionIndex = questionIndex;
                examState.questions = questionsDatabase[type];

                // Start timer if not already started and it's a reading exam
                if (type === 'reading' && !examState.timerStarted) {
                    startTimer();
                    examState.timerStarted = true;
                }

                // Show timer only for reading exams
                if (type === 'reading') {
                    document.getElementById('timerDisplay').classList.add('active');
                } else {
                    document.getElementById('timerDisplay').classList.remove('active');
                }

                displayQuestion();
                document.getElementById('examModal').classList.add('active');
            }

            // Display question
            function displayQuestion() {
                const question = examState.questions[examState.currentQuestionIndex];
                const modal = document.getElementById('examModal');

                document.getElementById('modalTitle').textContent = 
                    examState.currentExamType.charAt(0).toUpperCase() + examState.currentExamType.slice(1) + ' Exam';
                document.getElementById('questionNumber').textContent = 
                    `Question ${examState.currentQuestionIndex + 1} of ${examState.questions.length}`;
                
                // Convert markdown-style bold to HTML and display as HTML
                const formattedText = question.text
                    .split('\n')
                    .map(line => {
                        if (line.includes('**')) {
                            return line.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
                        }
                        return line;
                    })
                    .join('<br>');
                
                document.getElementById('questionText').innerHTML = formattedText;

                // Generate answer options
                const answerContainer = document.getElementById('answerOptions');
                answerContainer.innerHTML = '';

                const options = ['A', 'B', 'C', 'D'];
                question.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'answer-option';

                    const input = document.createElement('input');
                    input.type = 'radio';
                    input.name = 'answer';
                    input.value = index;
                    input.id = `option_${index}`;

                    const label = document.createElement('label');
                    label.htmlFor = `option_${index}`;
                    label.textContent = `${options[index]}) ${option}`;

                    optionDiv.appendChild(input);
                    optionDiv.appendChild(label);
                    answerContainer.appendChild(optionDiv);

                    // Restore previous answer if exists
                    const answerId = `${examState.currentExamType}_${examState.currentQuestionIndex}`;
                    if (examState.answers[answerId] === index) {
                        input.checked = true;
                    }
                });

                // Update button states
                document.querySelector('.modal-btn-back').disabled = examState.currentQuestionIndex === 0;
                document.querySelector('.modal-btn-next').disabled = examState.currentQuestionIndex === examState.questions.length - 1;
            }

            // Save answer
            function saveAnswer() {
                const selected = document.querySelector('input[name="answer"]:checked');
                if (selected) {
                    const answerId = `${examState.currentExamType}_${examState.currentQuestionIndex}`;
                    examState.answers[answerId] = parseInt(selected.value);
                }
            }

            // Next question
            function nextQuestion() {
                saveAnswer();
                if (examState.currentQuestionIndex < examState.questions.length - 1) {
                    examState.currentQuestionIndex++;
                    displayQuestion();
                }
            }

            // Previous question
            function previousQuestion() {
                saveAnswer();
                if (examState.currentQuestionIndex > 0) {
                    examState.currentQuestionIndex--;
                    displayQuestion();
                }
            }

            // Close exam
            function closeExam() {
                saveAnswer();
                document.getElementById('examModal').classList.remove('active');
            }

            // Submit exam and calculate results
            function submitExam() {
                saveAnswer();
                
                // Calculate results
                let correctCount = 0;
                let incorrectCount = 0;
                const resultDetails = [];

                examState.questions.forEach((question, index) => {
                    const answerId = `${examState.currentExamType}_${index}`;
                    const userAnswer = examState.answers[answerId];
                    const isCorrect = userAnswer === question.correctAnswer;

                    if (isCorrect) {
                        correctCount++;
                    } else {
                        incorrectCount++;
                    }

                    resultDetails.push({
                        questionNumber: question.number,
                        question: question.text,
                        options: question.options,
                        userAnswer: userAnswer,
                        correctAnswer: question.correctAnswer,
                        isCorrect: isCorrect
                    });
                });

                // Display results
                displayResults(correctCount, incorrectCount, resultDetails);
            }

            // Display results modal
            function displayResults(correct, incorrect, details) {
                const total = examState.questions.length;
                const percentage = Math.round((correct / total) * 100);
                const score = Math.round((correct / total) * 100);

                // Update score display
                document.getElementById('scoreDisplay').textContent = `${correct}/${total}`;
                document.getElementById('scoreText').textContent = `점수: ${score}점`;
                document.getElementById('scorePercentage').textContent = `정답률: ${percentage}%`;
                document.getElementById('correctCount').textContent = correct;
                document.getElementById('incorrectCount').textContent = incorrect;
                document.getElementById('totalCount').textContent = total;

                // Create detailed results
                const detailedHTML = createDetailedResults(details);
                document.getElementById('detailedResults').innerHTML = detailedHTML;

                // Show results modal
                document.getElementById('examModal').classList.remove('active');
                document.getElementById('resultsModal').classList.add('active');
            }

            // Create detailed results HTML
            function createDetailedResults(details) {
                let html = '<div class="results-title">상세 결과</div>';

                details.forEach(detail => {
                    const isCorrect = detail.isCorrect;
                    const itemClass = isCorrect ? 'correct' : '';
                    const userAnswerText = detail.userAnswer !== undefined ? 
                        detail.options[detail.userAnswer] : '답변 없음';
                    const correctAnswerText = detail.options[detail.correctAnswer];

                    html += `
                        <div class="wrong-answer-item ${itemClass}">
                            <div class="question-num">문제 ${detail.questionNumber}</div>
                            <div class="question-text">${detail.question}</div>
                            <div class="answer-feedback">
                                <p><span class="your-answer">당신의 답: ${userAnswerText}</span></p>
                                <p><span class="correct-answer">정답: ${correctAnswerText}</span></p>
                                <p>${isCorrect ? '✓ 정답입니다!' : '✗ 오답입니다.'}</p>
                            </div>
                        </div>
                    `;
                });

                return html;
            }

            // Retake exam
            function retakeExam() {
                // Reset exam state
                examState.currentQuestionIndex = 0;
                examState.answers = {};
                examState.timerStarted = false;
                examState.timeRemaining = 25 * 60;

                // Close results modal
                document.getElementById('resultsModal').classList.remove('active');

                // Reload page to start fresh
                location.reload();
            }

            // Back to exams
            function backToExams() {
                document.getElementById('resultsModal').classList.remove('active');
                location.href = 'exams.html';
            }

            // Timer functions
            function startTimer() {
                examState.timerInterval = setInterval(() => {
                    if (examState.timeRemaining > 0) {
                        examState.timeRemaining--;
                        updateTimerDisplay();
                        saveTimerState();
                    } else {
                        clearInterval(examState.timerInterval);
                    }
                }, 1000);
            }

            function updateTimerDisplay() {
                const minutes = Math.floor(examState.timeRemaining / 60);
                const seconds = examState.timeRemaining % 60;
                const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                document.getElementById('timerText').textContent = timeString;

                const timerElement = document.getElementById('timerDisplay');
                if (examState.timeRemaining < 300) { // Less than 5 minutes
                    timerElement.classList.add('warning');
                } else {
                    timerElement.classList.remove('warning');
                }
            }

            function saveTimerState() {
                sessionStorage.setItem('examTimerState', JSON.stringify({
                    timeRemaining: examState.timeRemaining,
                    timerStarted: examState.timerStarted
                }));
            }

            function loadTimerState() {
                const saved = sessionStorage.getItem('examTimerState');
                if (saved) {
                    const state = JSON.parse(saved);
                    examState.timeRemaining = state.timeRemaining;
                    examState.timerStarted = state.timerStarted;
                    
                    if (examState.timerStarted) {
                        startTimer();
                        document.getElementById('timerDisplay').classList.add('active');
                        updateTimerDisplay();
                    }
                }
            }

            // Close modal when clicking outside
            window.onclick = function(event) {
                const modal = document.getElementById('examModal');
                if (event.target == modal) {
                    closeExam();
                }
            }

            // Initialize on page load
            document.addEventListener('DOMContentLoaded', initializeExamPage);

            // Clean up timer when leaving page
            window.addEventListener('beforeunload', function() {
                if (examState.timerInterval) {
                    clearInterval(examState.timerInterval);
                }
            });
        </script>

    </body>
</html>
